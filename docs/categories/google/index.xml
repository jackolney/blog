<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Google on Jack Olney</title>
    <link>https://jackolney.github.io/blog/categories/google/index.xml</link>
    <description>Recent content in Google on Jack Olney</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <atom:link href="https://jackolney.github.io/blog/categories/google/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Fun with GoogleDocs API</title>
      <link>https://jackolney.github.io/blog/post/2015-01-01-fun-with-googledocs/</link>
      <pubDate>Thu, 01 Jan 2015 09:41:00 +0000</pubDate>
      
      <guid>https://jackolney.github.io/blog/post/2015-01-01-fun-with-googledocs/</guid>
      <description>

&lt;p&gt;I wanted to document some code for accessing documents (only spreadsheets at the moment) through GoogleDocs using the DIDE cluster and R.&lt;/p&gt;

&lt;h3 id=&#34;getting-started&#34;&gt;Getting started.&lt;/h3&gt;

&lt;p&gt;The R code is fairly self explanatory but involves two little tricks to get it to work: (1) manipulating the GoogleDocs URL to export the document as a csv and (2) changes the privilages on the document such that anyone with the link can edit (done under sharing).&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #272822&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #75715e&#34;&gt;# Set working directory.&lt;/span&gt;
&lt;span style=&#34;color: #66d9ef&#34;&gt;setwd&lt;/span&gt;&lt;span style=&#34;color: #f8f8f2&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #e6db74&#34;&gt;&amp;quot;[yourWorkingDirectory]&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #f8f8f2&#34;&gt;)&lt;/span&gt;

&lt;span style=&#34;color: #75715e&#34;&gt;# Install RCurl on cluster.&lt;/span&gt;
install.packages&lt;span style=&#34;color: #f8f8f2&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #e6db74&#34;&gt;&amp;quot;RCurl&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #f8f8f2&#34;&gt;,&lt;/span&gt;repos&lt;span style=&#34;color: #f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color: #e6db74&#34;&gt;&amp;quot;http://cran.ma.imperial.ac.uk&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #f8f8f2&#34;&gt;,&lt;/span&gt;lib&lt;span style=&#34;color: #f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color: #e6db74&#34;&gt;&amp;quot;[yourLibraryDirectory]&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #f8f8f2&#34;&gt;)&lt;/span&gt;

&lt;span style=&#34;color: #75715e&#34;&gt;# Now, with the desired GoogleSpreadsheet open in your browser copy the &amp;quot;Key&amp;quot; (the series of numbers and letters after /d/...) from the URL and insert it where [yourDocumentKey] is.&lt;/span&gt;
url &lt;span style=&#34;color: #f92672&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span style=&#34;color: #e6db74&#34;&gt;&amp;quot;https://docs.google.com/spreadsheets/d/[yourDocumentKey]/export?format=csv&amp;quot;&lt;/span&gt;

&lt;span style=&#34;color: #75715e&#34;&gt;# In your browser, go to &amp;quot;Share&amp;quot; and alter the document privilages so &amp;quot;anyone with a link can view&amp;quot;.&lt;/span&gt;

&lt;span style=&#34;color: #75715e&#34;&gt;# Load up RCurl (bitops is required by RCurl so best to load that too.)&lt;/span&gt;
&lt;span style=&#34;color: #f92672&#34;&gt;require&lt;/span&gt;&lt;span style=&#34;color: #f8f8f2&#34;&gt;(&lt;/span&gt;bitops&lt;span style=&#34;color: #f8f8f2&#34;&gt;,&lt;/span&gt;lib.loc&lt;span style=&#34;color: #f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color: #e6db74&#34;&gt;&amp;quot;[yourLibraryDirectory]&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #f8f8f2&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color: #f92672&#34;&gt;require&lt;/span&gt;&lt;span style=&#34;color: #f8f8f2&#34;&gt;(&lt;/span&gt;RCurl&lt;span style=&#34;color: #f8f8f2&#34;&gt;,&lt;/span&gt;lib.loc&lt;span style=&#34;color: #f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color: #e6db74&#34;&gt;&amp;quot;[yourLibraryDirectory]&amp;quot;&lt;/span&gt;&lt;span style=&#34;color: #f8f8f2&#34;&gt;)&lt;/span&gt;

&lt;span style=&#34;color: #75715e&#34;&gt;# Set ssl.verifypeer to FALSE.&lt;/span&gt;
myCsv &lt;span style=&#34;color: #f92672&#34;&gt;&amp;lt;-&lt;/span&gt; getURL&lt;span style=&#34;color: #f8f8f2&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #66d9ef&#34;&gt;url&lt;/span&gt;&lt;span style=&#34;color: #f8f8f2&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color: #ae81ff&#34;&gt;.&lt;/span&gt;opts&lt;span style=&#34;color: #f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color: #66d9ef&#34;&gt;list&lt;/span&gt;&lt;span style=&#34;color: #f8f8f2&#34;&gt;(&lt;/span&gt;ssl.verifypeer&lt;span style=&#34;color: #f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color: #66d9ef&#34;&gt;FALSE&lt;/span&gt;&lt;span style=&#34;color: #f8f8f2&#34;&gt;))&lt;/span&gt;

&lt;span style=&#34;color: #75715e&#34;&gt;# Parse csv data.&lt;/span&gt;
testCsv &lt;span style=&#34;color: #f92672&#34;&gt;&amp;lt;-&lt;/span&gt; read.csv&lt;span style=&#34;color: #f8f8f2&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color: #66d9ef&#34;&gt;textConnection&lt;/span&gt;&lt;span style=&#34;color: #f8f8f2&#34;&gt;(&lt;/span&gt;myCsv&lt;span style=&#34;color: #f8f8f2&#34;&gt;))&lt;/span&gt;

&lt;span style=&#34;color: #75715e&#34;&gt;# Print out result.&lt;/span&gt;
&lt;span style=&#34;color: #66d9ef&#34;&gt;print&lt;/span&gt;&lt;span style=&#34;color: #f8f8f2&#34;&gt;(&lt;/span&gt;testCsv&lt;span style=&#34;color: #f8f8f2&#34;&gt;)&lt;/span&gt;
flush.console&lt;span style=&#34;color: #f8f8f2&#34;&gt;()&lt;/span&gt;

&lt;span style=&#34;color: #75715e&#34;&gt;# SUCCESS!&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>